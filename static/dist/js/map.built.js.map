{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$textPerfectionNotify","$selectStyle","$selectIconResolution","$selectIconSize","$selectOpenGymsOnly","$selectTeamGymsOnly","$selectLastUpdateGymsOnly","$selectMinGymLevel","$selectMaxGymLevel","$selectLuredPokestopsOnly","$selectGymMarkerStyle","$selectLocationIconMarker","$switchGymSidebar","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","timestamp","excludedPokemon","notifiedPokemon","notifiedRarity","notifiedMinPerfection","buffer","reincludedPokemon","reids","map","rawDataIsLoading","locationMarker","rangeMarkers","storeZoom","scanPath","moves","oSwLat","oSwLng","oNeLat","oNeLng","lastpokestops","lastgyms","lastpokemon","lastslocs","lastspawns","selectedStyle","updateWorker","lastUpdateTime","gymTypes","gymPrestige","audio","Audio","genderType","unownForm","notifyIvTitle","notifyNoIvTitle","notifyText","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","stylePgoDay","pGoStyleDay","stylePgoNight","pGoStyleNight","currentDate","Date","currentHour","getHours","stylePgoDynamic","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","lurePokemons","createMyLocationButton","initSidebar","updateLocationMarker","setIcon","icon","createLocationMarker","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","$","prop","toggle","icons","each","pokemonSprites","key","value","append","attr","text","pad","number","slice","getTypeSpan","type","openMapDirections","url","window","open","getDateStr","t","dateStr","moment","format","pokemonLabel","item","rarityDisplay","types","typesDisplay","latitude","longitude","disappearTime","disappearDate","atk","def","sta","pMove1","undefined","i8ln","pMove2","weight","height","gender","form","cp","cpMultiplier","level","index","details","iv","getIv","toFixed","pokemonLevel","getPokemonLevel","contentstring","getMinutes","getSeconds","gymLabel","teamName","teamId","gymPoints","lastScanned","arguments","length","lastModified","members","guardPokemon","memberStr","i","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastModifiedStr","lastScannedStr","directionsStr","nameStr","gymColor","str","gymLevel","getGymLevel","points","pokestopLabel","expireTime","expireDate","formatSpawnTime","seconds","Math","floor","substr","spawnpointLabel","time","special","addRangeCircle","targetmap","circleCenter","LatLng","gymColors","teamColor","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","stm","round","lpad","len","padstr","Array","max","String","join","repArray","find","replace","getTimeUntil","now","tdiff","sec","min","hour","getNotifyText","ntitle","dist","toLocaleString","minute","second","hour12","until","udist","ntext","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","indexOf","play","sendNotification","fav_title","fav_text","BOUNCE","perfection","setupGymMarker","scaledSize","Size","gymSidebar","querySelector","getAttribute","classList","contains","remove","setAttribute","showGymDetails","persist","isMobileDevice","isTouchDevice","clearSelection","updateLabelDiffTime","close","updateGymMarker","setContent","updateGymIcons","gyms","setupPokestopMarker","imagename","getColorByDate","diff","hue","toString","setupScannedMarker","clickable","getColorBySpawnTime","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","selection","empty","getSelection","removeAllRanges","infoWindowIsOpen","clearStaleMarkers","getTime","scanned","showInBoundsMarkers","markers","show","getBounds","intersects","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","loadLuredOnly","Boolean","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","timeout","data","dataType","cache","beforeSend","error","toastr","options","complete","processPokemons","setupPokemonMarker","processPokestops","pokestops","item2","updatePokestops","removeStops","currentTime","push","processGyms","gym_points","removeGymFromMap","gymid","gymHasOpenSpot","pokemonInGym","pokemon","closePrestige","last_scanned","last_modified","processScanned","scanId","updateScanned","setOptions","processSpawnpoints","spawnpoints","updateSpawnPoints","setZIndex","done","result","hasClass","countMarkers","filter","e","drawScanPath","scanPathPoints","idx","point","Polyline","path","geodesic","pokemonList","newMarker","element","disappearsAt","parseInt","hours","minutes","timestring","ttime","getPointDistance","pointA","pointB","geometry","spherical","computeDistanceBetween","title","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","setInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setPosition","setCenter","clearInterval","changeLocation","loc","changeSearchLocation","post","setZoom","word","isEmptyObject","async","success","jqXHR","status","_error","console","log","updateGeoLocation","panTo","createUpdateWorker","Worker","updateBlob","Blob","updateBlobURL","URL","createObjectURL","onmessage","postMessage","ex","message","sidebar","sidebarClose","add","nextLvlPrestige","prestigePercentage","freeSlots","freeSlotsStr","gymLevelStr","pokemonHtml","headerHtml","perfectPercent","iv_attack","iv_defense","iv_stamina","moveEnergy","move_2_energy","move_1_name","move_1_type","toLowerCase","move_1_damage","move_2_name","move_2_type","move_2_damage","guard_pokemon_id","guard_pokemon_name","innerHTML","href","className","tabIndex","preventDefault","stopPropagation","toggleGymPokemonDetails","lastElementChild","firstElementChild","nextElementSibling","err","getJSON","styleList","select2","placeholder","minimumResultsForSearch","Infinity","on","checked","d","dType","searchMarkerStyleList","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","Number","isNaN","buildSwitchChangeListener","storageKey","change","wrapper","hide","wrapper2","bind","setDraggable","accordion","active","collapsible","heightStyle","DataTable","paging","searching","info","errMode","order"],"mappings":"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","file":"map.built.js","sourcesContent":["//\n// Global map.js variables\n//\n\nvar $selectExclude\nvar $selectPokemonNotify\nvar $selectRarityNotify\nvar $textPerfectionNotify\nvar $selectStyle\nvar $selectIconResolution\nvar $selectIconSize\nvar $selectOpenGymsOnly\nvar $selectTeamGymsOnly\nvar $selectLastUpdateGymsOnly\nvar $selectMinGymLevel\nvar $selectMaxGymLevel\nvar $selectLuredPokestopsOnly\nvar $selectGymMarkerStyle\nvar $selectLocationIconMarker\nvar $switchGymSidebar\n\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\nvar idToPokemon = {}\nvar i8lnDictionary = {}\nvar languageLookups = 0\nvar languageLookupThreshold = 3\n\nvar searchMarkerStyles\n\nvar timestamp\nvar excludedPokemon = []\nvar notifiedPokemon = []\nvar notifiedRarity = []\nvar notifiedMinPerfection = null\n\nvar buffer = []\nvar reincludedPokemon = []\nvar reids = []\n\nvar map\nvar rawDataIsLoading = false\nvar locationMarker\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\nvar storeZoom = true\nvar scanPath\nvar moves\n\nvar oSwLat\nvar oSwLng\nvar oNeLat\nvar oNeLng\n\nvar lastpokestops\nvar lastgyms\nvar lastpokemon\nvar lastslocs\nvar lastspawns\n\nvar selectedStyle = 'light'\n\nvar updateWorker\nvar lastUpdateTime\n\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\nvar gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\nvar audio = new Audio('static/sounds/ding.mp3')\n\nvar genderType = ['♂', '♀', '⚲']\nvar unownForm = ['unset', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '!', '?']\n\n/*\n text place holders:\n <pkm> - pokemon name\n <prc> - iv in percent without percent symbol\n <atk> - attack as number\n <def> - defense as number\n <sta> - stamnia as number\n */\nvar notifyIvTitle = '<pkm> <prc>% (<atk>/<def>/<sta>)'\nvar notifyNoIvTitle = '<pkm>'\n\n/*\n text place holders:\n <dist>  - disappear time\n <udist> - time until disappear\n */\nvar notifyText = 'disappears at <dist> (<udist>)'\n\n//\n// Functions\n//\n\nfunction excludePokemon(id) { // eslint-disable-line no-unused-vars\n    $selectExclude.val(\n        $selectExclude.val().concat(id)\n    ).trigger('change')\n}\n\nfunction notifyAboutPokemon(id) { // eslint-disable-line no-unused-vars\n    $selectPokemonNotify.val(\n        $selectPokemonNotify.val().concat(id)\n    ).trigger('change')\n}\n\nfunction removePokemonMarker(encounterId) { // eslint-disable-line no-unused-vars\n    if (mapData.pokemons[encounterId].marker.rangeCircle) {\n        mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\n        delete mapData.pokemons[encounterId].marker.rangeCircle\n    }\n    mapData.pokemons[encounterId].marker.setMap(null)\n    mapData.pokemons[encounterId].hidden = true\n}\n\nfunction initMap() { // eslint-disable-line no-unused-vars\n    map = new google.maps.Map(document.getElementById('map'), {\n        center: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        zoom: zoom == null ? Store.get('zoomLevel') : zoom,\n        fullscreenControl: true,\n        streetViewControl: false,\n        mapTypeControl: false,\n        clickableIcons: false,\n        mapTypeControlOptions: {\n            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\n            position: google.maps.ControlPosition.RIGHT_TOP,\n            mapTypeIds: [\n                google.maps.MapTypeId.ROADMAP,\n                google.maps.MapTypeId.SATELLITE,\n                google.maps.MapTypeId.HYBRID,\n                'nolabels_style',\n                'dark_style',\n                'style_light2',\n                'style_pgo',\n                'dark_style_nl',\n                'style_light2_nl',\n                'style_pgo_nl',\n                'style_pgo_day',\n                'style_pgo_night',\n                'style_pgo_dynamic'\n            ]\n        }\n    })\n\n    var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\n        name: 'No Labels'\n    })\n    map.mapTypes.set('nolabels_style', styleNoLabels)\n\n    var styleDark = new google.maps.StyledMapType(darkStyle, {\n        name: 'Dark'\n    })\n    map.mapTypes.set('dark_style', styleDark)\n\n    var styleLight2 = new google.maps.StyledMapType(light2Style, {\n        name: 'Light2'\n    })\n    map.mapTypes.set('style_light2', styleLight2)\n\n    var stylePgo = new google.maps.StyledMapType(pGoStyle, {\n        name: 'PokemonGo'\n    })\n    map.mapTypes.set('style_pgo', stylePgo)\n\n    var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\n        name: 'Dark (No Labels)'\n    })\n    map.mapTypes.set('dark_style_nl', styleDarkNl)\n\n    var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\n        name: 'Light2 (No Labels)'\n    })\n    map.mapTypes.set('style_light2_nl', styleLight2Nl)\n\n    var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\n        name: 'PokemonGo (No Labels)'\n    })\n    map.mapTypes.set('style_pgo_nl', stylePgoNl)\n\n    var stylePgoDay = new google.maps.StyledMapType(pGoStyleDay, {\n        name: 'PokemonGo Day'\n    })\n    map.mapTypes.set('style_pgo_day', stylePgoDay)\n\n    var stylePgoNight = new google.maps.StyledMapType(pGoStyleNight, {\n        name: 'PokemonGo Night'\n    })\n    map.mapTypes.set('style_pgo_night', stylePgoNight)\n\n    // dynamic map style chooses stylePgoDay or stylePgoNight depending on client time\n    var currentDate = new Date()\n    var currentHour = currentDate.getHours()\n    var stylePgoDynamic = currentHour >= 6 && currentHour < 19 ? stylePgoDay : stylePgoNight\n    map.mapTypes.set('style_pgo_dynamic', stylePgoDynamic)\n\n    map.addListener('maptypeid_changed', function (s) {\n        Store.set('map_style', this.mapTypeId)\n    })\n\n    map.setMapTypeId(Store.get('map_style'))\n    map.addListener('idle', updateMap)\n\n    map.addListener('zoom_changed', function () {\n        if (storeZoom === true) {\n            Store.set('zoomLevel', this.getZoom())\n        } else {\n            storeZoom = true\n        }\n\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    createMyLocationButton()\n    initSidebar()\n}\n\nfunction updateLocationMarker(style) {\n    if (style in searchMarkerStyles) {\n        locationMarker.setIcon(searchMarkerStyles[style].icon)\n        Store.set('locationMarkerStyle', style)\n    }\n    return locationMarker\n}\n\nfunction createLocationMarker() {\n    var position = Store.get('followMyLocationPosition')\n    var lat = 'lat' in position ? position.lat : centerLat\n    var lng = 'lng' in position ? position.lng : centerLng\n\n    var locationMarker = new google.maps.Marker({\n        map: map,\n        animation: google.maps.Animation.DROP,\n        position: {\n            lat: lat,\n            lng: lng\n        },\n        draggable: false,\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 2\n    })\n\n    locationMarker.setIcon(searchMarkerStyles[Store.get('locationMarkerStyle')].icon)\n\n    locationMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>My Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(locationMarker)\n\n    google.maps.event.addListener(locationMarker, 'dragend', function () {\n        var newLocation = locationMarker.getPosition()\n        Store.set('followMyLocationPosition', {\n            lat: newLocation.lat(),\n            lng: newLocation.lng()\n        })\n    })\n\n    return locationMarker\n}\n\nfunction initSidebar() {\n    $('#gyms-switch').prop('checked', Store.get('showGyms'))\n    $('#gym-sidebar-switch').prop('checked', Store.get('useGymSidebar'))\n    $('#gym-sidebar-wrapper').toggle(Store.get('showGyms'))\n    $('#gyms-filter-wrapper').toggle(Store.get('showGyms'))\n    $('#team-gyms-only-switch').val(Store.get('showTeamGymsOnly'))\n    $('#open-gyms-only-switch').val(Store.get('showOpenGymsOnly'))\n    $('#min-level-gyms-filter-switch').val(Store.get('minGymLevel'))\n    $('#max-level-gyms-filter-switch').val(Store.get('maxGymLevel'))\n    $('#last-update-gyms-switch').val(Store.get('showLastUpdatedGymsOnly'))\n    $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\n    $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\n    $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\n    $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\n    $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\n    $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\n    $('#scanned-switch').prop('checked', Store.get('showScanned'))\n    $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\n    $('#ranges-switch').prop('checked', Store.get('showRanges'))\n    $('#sound-switch').prop('checked', Store.get('playSound'))\n\n    var icons = $('#pokemon-icons')\n    $.each(pokemonSprites, function (key, value) {\n        icons.append($('<option></option>').attr('value', key).text(value.name))\n    })\n    icons.val(pokemonSprites[Store.get('pokemonIcons')] ? Store.get('pokemonIcons') : 'highres')\n\n    $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\n}\n\nfunction pad(number) {\n    return number <= 99 ? ('0' + number).slice(-2) : number\n}\n\nfunction getTypeSpan(type) {\n    return '<span style=\\'padding: 2px 5px text-transform: uppercase color: white margin-right: 2px border-radius: 4px font-size: 0.8em vertical-align: text-bottom background-color: ' + type['color'] + '\\'>' + type['type'] + '</span>'\n}\n\nfunction openMapDirections(lat, lng) { // eslint-disable-line no-unused-vars\n    var url = 'https://www.google.com/maps/?daddr=' + lat + ',' + lng\n    window.open(url, '_blank')\n}\n\n// Converts timestamp to readable String\nfunction getDateStr(t) {\n    var dateStr = 'Unknown'\n    if (t) {\n        dateStr = moment(t).format('DD-MM-YYYY, HH:mm:ss')\n    }\n    return dateStr\n}\n\nfunction pokemonLabel(item) {\n    var name = item['pokemon_name']\n    var rarityDisplay = item['pokemon_rarity'] ? '(' + item['pokemon_rarity'] + ')' : ''\n    var types = item['pokemon_types']\n    var typesDisplay = ''\n    var encounterId = item['encounter_id']\n    var id = item['pokemon_id']\n    var latitude = item['latitude']\n    var longitude = item['longitude']\n    var disappearTime = item['disappear_time']\n    var disappearDate = new Date(disappearTime)\n    var atk = item['individual_attack']\n    var def = item['individual_defense']\n    var sta = item['individual_stamina']\n    var pMove1 = moves[item['move_1']] !== undefined ? i8ln(moves[item['move_1']]['name']) : 'gen/unknown'\n    var pMove2 = moves[item['move_2']] !== undefined ? i8ln(moves[item['move_2']]['name']) : 'gen/unknown'\n    var weight = item['weight']\n    var height = item['height']\n    var gender = item['gender']\n    var form = item['form']\n    var cp = item['cp']\n    var cpMultiplier = item['cp_multiplier']\n    var level = item['level']\n\n    $.each(types, function (index, type) {\n        typesDisplay += getTypeSpan(type)\n    })\n\n    var details = ''\n    if (atk != null && def != null && sta != null) {\n        var iv = getIv(atk, def, sta)\n        details =\n            '<div>' +\n            'IV: ' + iv.toFixed(1) + '% (' + atk + '/' + def + '/' + sta + ')' +\n            '</div>'\n\n        if (cp != null && (cpMultiplier != null || level != null)) {\n            var pokemonLevel\n            if (level != null) {\n                pokemonLevel = level\n            } else {\n                pokemonLevel = getPokemonLevel(cpMultiplier)\n            }\n            details +=\n                '<div>' +\n                'CP: ' + cp + ' | Level: ' + pokemonLevel +\n                '</div>'\n        }\n\n        details +=\n            '<div>' +\n            'Moves: ' + pMove1 + ' / ' + pMove2 +\n            '</div>'\n    }\n    if (gender != null) {\n        details +=\n            '<div>' +\n            'Gender: ' + genderType[gender - 1]\n        if (weight != null && height != null) {\n            details += ' | Weight: ' + weight.toFixed(2) + 'kg | Height: ' + height.toFixed(2) + 'm'\n        }\n        details +=\n            '</div>'\n    }\n    var contentstring =\n        '<div>' +\n        '<b>' + name + '</b>'\n    if (id === 201 && form !== null && form > 0) {\n        contentstring += ' (' + unownForm[item['form']] + ')'\n    }\n    contentstring += '<span> - </span>' +\n        '<small>' +\n        '<a href=\"http://www.pokemon.com/us/pokedex/' + id + '\" target=\"_blank\" title=\"View in Pokedex\">#' + id + '</a>' +\n        '</small>' +\n        '<span> ' + rarityDisplay + '</span>' +\n        '<span> - </span>' +\n        '<small>' + typesDisplay + '</small>' +\n        '</div>' +\n        '<div>' +\n        'Disappears at ' + pad(disappearDate.getHours()) + ':' + pad(disappearDate.getMinutes()) + ':' + pad(disappearDate.getSeconds()) +\n        '<span class=\"label-countdown\" disappears-at=\"' + disappearTime + '\">(00m00s)</span>' +\n        '</div>' +\n        '<div>' +\n        'Location: ' + latitude.toFixed(6) + ', ' + longitude.toFixed(7) +\n        '</div>' +\n        details +\n        '<div>' +\n        '<a href=\"javascript:excludePokemon(' + id + ')\">Exclude</a>&nbsp&nbsp' +\n        '<a href=\"javascript:notifyAboutPokemon(' + id + ')\">Notify</a>&nbsp&nbsp' +\n        '<a href=\"javascript:removePokemonMarker\\'\"' + encounterId + '\\')\">Remove</a>&nbsp&nbsp' +\n        '<a href=\"javascript:void(0)\" onclick=\"javascript:openMapDirections(' + latitude + ', ' + longitude + ')\" title=\"View in Maps\">Get directions</a>' +\n        '</div>'\n    return contentstring\n}\n\nfunction gymLabel(teamName, teamId, gymPoints, latitude, longitude) {\n    var lastScanned = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null\n    var lastModified = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null\n    var name = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null\n    var members = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : []\n    // var gymId = arguments[9]\n    var guardPokemon = arguments[10]\n\n    var memberStr = ''\n    if (members.length > 0) {\n        for (var i = 0; i < members.length; i++) {\n            memberStr +=\n                '<span class=\"gym-member\" title=\"' + members[i].pokemon_name + ' | ' + members[i].trainer_name + ' (Lvl ' + members[i].trainer_level + '\">' +\n                '<i class=\"pokemon-sprite n' + members[i].pokemon_id + '\"></i>' +\n                '<span class=\"cp team-' + teamId + '\">' + members[i].pokemon_cp + '</span>' +\n                '</span>'\n        }\n    } else {\n        memberStr =\n            '<span class=\"gym-member\">' +\n            '<i class=\"pokemon-sprite n' + guardPokemon + '\"></i>' +\n            '</span>'\n    }\n\n    var lastModifiedStr = getDateStr(lastModified)\n    var lastScannedStr = ''\n    if (lastScanned != null) {\n        lastScannedStr =\n            '<div>' +\n            'Last Scanned: ' + getDateStr(lastScanned) +\n            '</div>'\n    }\n    var directionsStr = ''\n    if (!Store.get('useGymSidebar')) {\n        directionsStr =\n            '<div>' +\n            '<a href=\\'javascript:void(0)\\' onclick=\\'javascript:openMapDirections(' + latitude + ',' + longitude + ')\\' title=\\'View in Maps\\'>Get directions</a>' +\n            '</div>'\n    }\n\n    var nameStr = name ? '<div>' + name + '</div>' : ''\n\n    var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\n    var str\n    if (teamId === 0) {\n        str = '<div> ' +\n            '<center>' +\n            '<div>' +\n            '<b style=\"color:rgba(' + gymColor[teamId] + ')\">' + teamName + '</b><br>' +\n            '<img height=\"70px\" style=\"padding: 5px\" src=\"static/forts/' + teamName + '_large.png\">' +\n            '</div>' +\n            nameStr +\n            '<div>' +\n            'Location: ' + latitude.toFixed(6) + ', ' + longitude.toFixed(7) +\n            '</div>' +\n            '<div>' +\n            'Last Modified: ' + lastModifiedStr +\n            '</div>' +\n            lastScannedStr +\n            directionsStr +\n            '</center>' +\n            '</div>'\n    } else {\n        var gymLevel = getGymLevel(gymPoints)\n        str =\n            '<div>' +\n            '<center>' +\n            '<div style=\"padding-bottom: 2px\">' +\n            'Gym owned by:' +\n            '</div>' +\n            '<div>' +\n            '<b style=\"color:rgba(' + gymColor[teamId] + ')\">Team ' + teamName + '</b><br>' +\n            '<img height=\"70px\" style=\"padding: 5px\" src=\"static/forts/' + teamName + '_large.png\">' +\n            '</div>' +\n            '<div>' +\n            nameStr +\n            '</div>' +\n            '<div>' +\n            'Level: ' + gymLevel + ' | Prestige: ' + gymPoints + '/' + (gymPrestige[gymLevel - 1] || 50000) +\n            '</div>' +\n            '<div>' + memberStr +\n            '</div>' +\n            '<div>' +\n            'Location: ' + latitude.toFixed(6) + ', ' + longitude.toFixed(7) +\n            '</div>' +\n            '<div>' +\n            'Last Modified: ' + lastModifiedStr +\n            '</div>' + lastScannedStr +\n            directionsStr +\n            '</center>' +\n            '</div>'\n    }\n\n    return str\n}\n\nfunction getGymLevel(points) {\n    var level = 1\n    while (points >= gymPrestige[level - 1]) {\n        level++\n    }\n\n    return level\n}\n\nfunction pokestopLabel(expireTime, latitude, longitude) {\n    var str\n    if (expireTime) {\n        var expireDate = new Date(expireTime)\n\n        str =\n            '<div>' +\n            '<b>Lured Pokéstop</b>' +\n            '</div>' +\n            '<div>' +\n            'Lure expires at ' + pad(expireDate.getHours()) + ':' + pad(expireDate.getMinutes()) + ':' + pad(expireDate.getSeconds()) +\n            '<span class=\"label-countdown\" disappears-at=\"' + expireTime + '\">(00m00s)</span>' +\n            '</div>' +\n            '<div>' +\n            'Location: ' + latitude.toFixed(6) + ', ' + longitude.toFixed(7) +\n            '</div>' +\n            '<div>' +\n            '<a href=\"javascript:void(0)\" onclick=\"javascript:openMapDirections(' + latitude + ',' + longitude + ')\" title=\"View in Maps\">Get directions</a>' +\n            '</div>'\n    } else {\n        str =\n            '<div>' +\n            '<b>Pokéstop</b>' +\n            '</div>' +\n            '<div>' +\n            'Location: ' + latitude.toFixed(6) + ', ' + longitude.toFixed(7) +\n            '</div>' +\n            '<div>' +\n            '<a href=\"javascript:void(0)\" onclick=\"javascript:openMapDirections(' + latitude + ',' + longitude + ')\" title=\"View in Maps\">Get directions</a>' +\n            '</div>'\n    }\n\n    return str\n}\n\nfunction formatSpawnTime(seconds) {\n    // the addition and modulo are required here because the db stores when a spawn disappears\n    // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\n    return ('0' + Math.floor((seconds + 3600) % 3600 / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\n}\n\nfunction spawnpointLabel(item) {\n    var str =\n        '<div>' +\n        '<b>Spawn Point</b>' +\n        '</div>' +\n        '<div>' +\n        'Every hour from ' + formatSpawnTime(item.time) + ' to ' + formatSpawnTime(item.time + 900) +\n        '</div>'\n\n    if (item.special) {\n        str +=\n            '<div>' +\n            'May appear as early as ' + formatSpawnTime(item.time - 1800) +\n            '</div>'\n    }\n    return str\n}\n\nfunction addRangeCircle(marker, map, type, teamId) {\n    var targetmap = null\n    var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\n    var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\n    var teamColor = gymColors[0]\n    if (teamId) teamColor = gymColors[teamId]\n\n    var range\n    var circleColor\n\n    // handle each type of marker and be explicit about the range circle attributes\n    switch (type) {\n        case 'pokemon':\n            circleColor = '#C233F2'\n            range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\n            break\n        case 'pokestop':\n            circleColor = '#3EB0FF'\n            range = 40\n            break\n        case 'gym':\n            circleColor = teamColor\n            range = 40\n            break\n    }\n\n    if (map) targetmap = map\n\n    var rangeCircleOpts = {\n        map: targetmap,\n        radius: range, // meters\n        strokeWeight: 1,\n        strokeColor: circleColor,\n        strokeOpacity: 0.9,\n        center: circleCenter,\n        fillColor: circleColor,\n        fillOpacity: 0.3\n    }\n    var rangeCircle = new google.maps.Circle(rangeCircleOpts)\n    return rangeCircle\n}\n\nfunction isRangeActive(map) {\n    if (map.getZoom() < 16) return false\n    return Store.get('showRanges')\n}\n\nfunction getIv(atk, def, stm) {\n    if (atk !== null) {\n        return 100.0 * (atk + def + stm) / 45\n    }\n\n    return false\n}\n\nfunction getPokemonLevel(cpMultiplier) {\n    if (cpMultiplier < 0.734) {\n        var pokemonLevel = 58.35178527 * cpMultiplier * cpMultiplier - 2.838007664 * cpMultiplier + 0.8539209906\n    } else {\n        pokemonLevel = 171.0112688 * cpMultiplier - 95.20425243\n    }\n    pokemonLevel = Math.round(pokemonLevel) * 2 / 2\n\n    return pokemonLevel\n}\n\nfunction lpad(str, len, padstr) {\n    return Array(Math.max(len - String(str).length + 1, 0)).join(padstr) + str\n}\n\nfunction repArray(text, find, replace) {\n    for (var i = 0; i < find.length; i++) {\n        text = text.replace(find[i], replace[i])\n    }\n\n    return text\n}\n\nfunction getTimeUntil(time) {\n    var now = +new Date()\n    var tdiff = time - now\n\n    var sec = Math.floor(tdiff / 1000 % 60)\n    var min = Math.floor(tdiff / 1000 / 60 % 60)\n    var hour = Math.floor(tdiff / (1000 * 60 * 60) % 24)\n\n    return {\n        'total': tdiff,\n        'hour': hour,\n        'min': min,\n        'sec': sec,\n        'now': now,\n        'ttime': time\n    }\n}\n\nfunction getNotifyText(item) {\n    var iv = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n    var find = ['<prc>', '<pkm>', '<atk>', '<def>', '<sta>']\n    var replace = [iv ? iv.toFixed(1) : '', item['pokemon_name'], item['individual_attack'], item['individual_defense'], item['individual_stamina']]\n    var ntitle = repArray(iv ? notifyIvTitle : notifyNoIvTitle, find, replace)\n    var dist = new Date(item['disappear_time']).toLocaleString([], {\n        hour: '2-digit', minute: '2-digit',\n        second: '2-digit', hour12: false\n    })\n    var until = getTimeUntil(item['disappear_time'])\n    var udist = until.hour > 0 ? until.hour + ':' : ''\n    udist += lpad(until.min, 2, 0) + 'm' + lpad(until.sec, 2, 0) + 's'\n    find = ['<dist>', '<udist>']\n    replace = [dist, udist]\n    var ntext = repArray(notifyText, find, replace)\n\n    return {\n        'fav_title': ntitle,\n        'fav_text': ntext\n    }\n}\n\nfunction customizePokemonMarker(marker, item, skipNotification) {\n    marker.addListener('click', function () {\n        this.setAnimation(null)\n        this.animationDisabled = true\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokemonLabel(item),\n        disableAutoPan: true\n    })\n\n    if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\n        if (!skipNotification) {\n            if (Store.get('playSound')) {\n                audio.play()\n            }\n            sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n        }\n        if (marker.animationDisabled !== true) {\n            marker.setAnimation(google.maps.Animation.BOUNCE)\n        }\n    }\n\n    if (item['individual_attack'] != null) {\n        var perfection = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n        if (notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection) {\n            if (!skipNotification) {\n                if (Store.get('playSound')) {\n                    audio.play()\n                }\n                sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n            }\n            if (marker.animationDisabled !== true) {\n                marker.setAnimation(google.maps.Animation.BOUNCE)\n            }\n        }\n    }\n\n    addListeners(marker)\n}\n\nfunction setupGymMarker(item) {\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        icon: {\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        }\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['last_modified'], item['name'], item['pokemon'], item['gym_id'], item['guard_pokemon_id']),\n        disableAutoPan: true\n    })\n\n    if (Store.get('useGymSidebar')) {\n        marker.addListener('click', function () {\n            var gymSidebar = document.querySelector('#gym-details')\n            if (gymSidebar.getAttribute('data-id') === item['gym_id'] && gymSidebar.classList.contains('visible')) {\n                gymSidebar.classList.remove('visible')\n            } else {\n                gymSidebar.setAttribute('data-id', item['gym_id'])\n                showGymDetails(item['gym_id'])\n            }\n        })\n\n        google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n            marker.persist = null\n        })\n\n        if (!isMobileDevice() && !isTouchDevice()) {\n            marker.addListener('mouseover', function () {\n                marker.infoWindow.open(map, marker)\n                clearSelection()\n                updateLabelDiffTime()\n            })\n        }\n\n        marker.addListener('mouseout', function () {\n            if (!marker.persist) {\n                marker.infoWindow.close()\n            }\n        })\n    } else {\n        addListeners(marker)\n    }\n    return marker\n}\n\nfunction updateGymMarker(item, marker) {\n    marker.setIcon({\n        url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n        scaledSize: new google.maps.Size(48, 48)\n    })\n    marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['last_modified'], item['name'], item['pokemon'], item['gym_id'], item['guard_pokemon_id']))\n    return marker\n}\n\nfunction updateGymIcons() {\n    $.each(mapData.gyms, function (key, value) {\n        mapData.gyms[key]['marker'].setIcon({\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[mapData.gyms[key]['team_id']] + (mapData.gyms[key]['team_id'] !== 0 ? '_' + getGymLevel(mapData.gyms[key]['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        })\n    })\n}\n\nfunction setupPokestopMarker(item) {\n    var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        zIndex: 2,\n        icon: 'static/forts/' + imagename + '.png'\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\n        disableAutoPan: true\n    })\n\n    addListeners(marker)\n    return marker\n}\n\nfunction getColorByDate(value) {\n    // Changes the color from red to green over 15 mins\n    var diff = (Date.now() - value) / 1000 / 60 / 15\n\n    if (diff > 1) {\n        diff = 1\n    }\n\n    // value from 0 to 1 - Green to Red\n    var hue = ((1 - diff) * 120).toString(10)\n    return ['hsl(', hue, ',100%,50%)'].join('')\n}\n\nfunction setupScannedMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n\n    var marker = new google.maps.Circle({\n        map: map,\n        clickable: false,\n        center: circleCenter,\n        radius: 70, // metres\n        fillColor: getColorByDate(item['last_modified']),\n        fillOpacity: 0.1,\n        strokeWeight: 1,\n        strokeOpacity: 0.5\n    })\n\n    return marker\n}\n\nfunction getColorBySpawnTime(value) {\n    var now = new Date()\n    var seconds = now.getMinutes() * 60 + now.getSeconds()\n\n    // account for hour roll-over\n    if (seconds < 900 && value > 2700) {\n        seconds += 3600\n    } else if (seconds > 2700 && value < 900) {\n        value += 3600\n    }\n\n    var diff = seconds - value\n    var hue = 275 // light purple when spawn is neither about to spawn nor active\n    if (diff >= 0 && diff <= 900) {\n        // green to red over 15 minutes of active spawn\n        hue = (1 - diff / 60 / 15) * 120\n    } else if (diff < 0 && diff > -300) {\n        // light blue to dark blue over 5 minutes til spawn\n        hue = (1 - -diff / 60 / 5) * 50 + 200\n    }\n\n    hue = Math.round(hue / 5) * 5\n\n    return hue\n}\n\nfunction changeSpawnIcon(color, zoom) {\n    var urlColor = ''\n    if (color === 275) {\n        urlColor = './static/icons/hsl-275-light.png'\n    } else {\n        urlColor = './static/icons/hsl-' + color + '.png'\n    }\n    var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\n    var minimumSize = 1\n    var newSize = Math.round(zoomScale * (zoom - 10) // this scales the icon based on zoom\n    )\n    if (newSize < minimumSize) {\n        newSize = minimumSize\n    }\n\n    var newIcon = {\n        url: urlColor,\n        scaledSize: new google.maps.Size(newSize, newSize),\n        anchor: new google.maps.Point(newSize / 2, newSize / 2)\n    }\n\n    return newIcon\n}\n\nfunction spawnPointIndex(color) {\n    var newIndex = 1\n    var scale = 0\n    if (color >= 0 && color <= 120) {\n        // high to low over 15 minutes of active spawn\n        scale = color / 120\n        newIndex = 100 + scale * 100\n    } else if (color >= 200 && color <= 250) {\n        // low to high over 5 minutes til spawn\n        scale = (color - 200) / 50\n        newIndex = scale * 100\n    }\n\n    return newIndex\n}\n\nfunction setupSpawnpointMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n    var hue = getColorBySpawnTime(item.time)\n    var zoom = map.getZoom()\n\n    var marker = new google.maps.Marker({\n        map: map,\n        position: circleCenter,\n        icon: changeSpawnIcon(hue, zoom),\n        zIndex: spawnPointIndex(hue)\n    })\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: spawnpointLabel(item),\n        disableAutoPan: true,\n        position: circleCenter\n    })\n\n    addListeners(marker)\n\n    return marker\n}\n\nfunction clearSelection() {\n    if (document.selection) {\n        document.selection.empty()\n    } else if (window.getSelection) {\n        window.getSelection().removeAllRanges()\n    }\n}\n\nfunction addListeners(marker) {\n    marker.addListener('click', function () {\n        if (!marker.infoWindowIsOpen) {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n            marker.persist = true\n            marker.infoWindowIsOpen = true\n        } else {\n            marker.persist = null\n            marker.infoWindow.close()\n            marker.infoWindowIsOpen = false\n        }\n    })\n\n    google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n        marker.persist = null\n    })\n\n    if (!isMobileDevice() && !isTouchDevice()) {\n        marker.addListener('mouseover', function () {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n        })\n    }\n\n    marker.addListener('mouseout', function () {\n        if (!marker.persist) {\n            marker.infoWindow.close()\n        }\n    })\n\n    return marker\n}\n\nfunction clearStaleMarkers() {\n    $.each(mapData.pokemons, function (key, value) {\n        if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() || excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0) {\n            if (mapData.pokemons[key].marker.rangeCircle) {\n                mapData.pokemons[key].marker.rangeCircle.setMap(null)\n                delete mapData.pokemons[key].marker.rangeCircle\n            }\n            mapData.pokemons[key].marker.setMap(null)\n            delete mapData.pokemons[key]\n        }\n    })\n\n    $.each(mapData.lurePokemons, function (key, value) {\n        if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() || excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\n            mapData.lurePokemons[key].marker.setMap(null)\n            delete mapData.lurePokemons[key]\n        }\n    })\n\n    $.each(mapData.scanned, function (key, value) {\n        // If older than 15mins remove\n        if (mapData.scanned[key]['last_modified'] < new Date().getTime() - 15 * 60 * 1000) {\n            mapData.scanned[key].marker.setMap(null)\n            delete mapData.scanned[key]\n        }\n    })\n}\n\nfunction showInBoundsMarkers(markers, type) {\n    $.each(markers, function (key, value) {\n        var marker = markers[key].marker\n        var show = false\n        if (!markers[key].hidden) {\n            if (typeof marker.getBounds === 'function') {\n                if (map.getBounds().intersects(marker.getBounds())) {\n                    show = true\n                }\n            } else if (typeof marker.getPosition === 'function') {\n                if (map.getBounds().contains(marker.getPosition())) {\n                    show = true\n                }\n            }\n        }\n        // marker has an associated range\n        if (show && rangeMarkers.indexOf(type) !== -1) {\n            // no range circle yet...let's create one\n            if (!marker.rangeCircle) {\n                // but only if range is active\n                if (isRangeActive(map)) {\n                    if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\n                    else marker.rangeCircle = addRangeCircle(marker, map, type)\n                }\n            } else {\n                // there's already a range circle\n                if (isRangeActive(map)) {\n                    marker.rangeCircle.setMap(map)\n                } else {\n                    marker.rangeCircle.setMap(null)\n                }\n            }\n        }\n\n        if (show && !marker.getMap()) {\n            marker.setMap(map\n                // Not all markers can be animated (ex: scan locations)\n            )\n            if (marker.setAnimation && marker.oldAnimation) {\n                marker.setAnimation(marker.oldAnimation)\n            }\n        } else if (!show && marker.getMap()) {\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.getAnimation) {\n                marker.oldAnimation = marker.getAnimation()\n            }\n            if (marker.rangeCircle) marker.rangeCircle.setMap(null)\n            marker.setMap(null)\n        }\n    })\n}\n\nfunction loadRawData() {\n    var loadPokemon = Store.get('showPokemon')\n    var loadGyms = Store.get('showGyms')\n    var loadPokestops = Store.get('showPokestops')\n    var loadScanned = Store.get('showScanned')\n    var loadSpawnpoints = Store.get('showSpawnpoints')\n    var loadLuredOnly = Boolean(Store.get('showLuredPokestopsOnly'))\n\n    var bounds = map.getBounds()\n    var swPoint = bounds.getSouthWest()\n    var nePoint = bounds.getNorthEast()\n    var swLat = swPoint.lat()\n    var swLng = swPoint.lng()\n    var neLat = nePoint.lat()\n    var neLng = nePoint.lng()\n\n    return $.ajax({\n        url: 'raw_data',\n        type: 'GET',\n        timeout: 300000,\n        data: {\n            'timestamp': timestamp,\n            'pokemon': loadPokemon,\n            'lastpokemon': lastpokemon,\n            'pokestops': loadPokestops,\n            'lastpokestops': lastpokestops,\n            'luredonly': loadLuredOnly,\n            'gyms': loadGyms,\n            'lastgyms': lastgyms,\n            'scanned': loadScanned,\n            'lastslocs': lastslocs,\n            'spawnpoints': loadSpawnpoints,\n            'lastspawns': lastspawns,\n            'swLat': swLat,\n            'swLng': swLng,\n            'neLat': neLat,\n            'neLng': neLng,\n            'oSwLat': oSwLat,\n            'oSwLng': oSwLng,\n            'oNeLat': oNeLat,\n            'oNeLng': oNeLng,\n            'reids': String(reincludedPokemon),\n            'eids': String(excludedPokemon)\n        },\n        dataType: 'json',\n        cache: false,\n        beforeSend: function beforeSend() {\n            if (rawDataIsLoading) {\n                return false\n            } else {\n                rawDataIsLoading = true\n            }\n        },\n        error: function error() {\n            // Display error toast\n            toastr['error']('Please check connectivity or reduce marker settings.', 'Error getting data')\n            toastr.options = {\n                'closeButton': true,\n                'debug': false,\n                'newestOnTop': true,\n                'progressBar': false,\n                'positionClass': 'toast-top-right',\n                'preventDuplicates': true,\n                'onclick': null,\n                'showDuration': '300',\n                'hideDuration': '1000',\n                'timeOut': '25000',\n                'extendedTimeOut': '1000',\n                'showEasing': 'swing',\n                'hideEasing': 'linear',\n                'showMethod': 'fadeIn',\n                'hideMethod': 'fadeOut'\n            }\n        },\n        complete: function complete() {\n            rawDataIsLoading = false\n        }\n    })\n}\n\nfunction processPokemons(i, item) {\n    if (!Store.get('showPokemon')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    if (!(item['encounter_id'] in mapData.pokemons) && excludedPokemon.indexOf(item['pokemon_id']) < 0 && item['disappear_time'] > Date.now()) {\n        // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        if (!item.hidden) {\n            item.marker = setupPokemonMarker(item, map)\n            customizePokemonMarker(item.marker, item)\n            mapData.pokemons[item['encounter_id']] = item\n        }\n    }\n}\n\nfunction processPokestops(i, item) {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\n        return true\n    }\n\n    if (!mapData.pokestops[item['pokestop_id']]) {\n        // new pokestop, add marker to map and item to dict\n        if (item.marker && item.marker.rangeCircle) {\n            item.marker.rangeCircle.setMap(null)\n        }\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupPokestopMarker(item)\n        mapData.pokestops[item['pokestop_id']] = item\n    } else {\n        // change existing pokestop marker to unlured/lured\n        var item2 = mapData.pokestops[item['pokestop_id']]\n        if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\n            if (item2.marker && item2.marker.rangeCircle) {\n                item2.marker.rangeCircle.setMap(null)\n            }\n            item2.marker.setMap(null)\n            item.marker = setupPokestopMarker(item)\n            mapData.pokestops[item['pokestop_id']] = item\n        }\n    }\n}\n\nfunction updatePokestops() {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    var removeStops = []\n    var currentTime = new Date().getTime()\n\n    // change lured pokestop marker to unlured when expired\n    $.each(mapData.pokestops, function (key, value) {\n        if (value['lure_expiration'] && value['lure_expiration'] < currentTime) {\n            value['lure_expiration'] = null\n            if (value.marker && value.marker.rangeCircle) {\n                value.marker.rangeCircle.setMap(null)\n            }\n            value.marker.setMap(null)\n            value.marker = setupPokestopMarker(value)\n        }\n    })\n\n    // remove unlured stops if show lured only is selected\n    if (Store.get('showLuredPokestopsOnly')) {\n        $.each(mapData.pokestops, function (key, value) {\n            if (!value['lure_expiration']) {\n                removeStops.push(key)\n            }\n        })\n        $.each(removeStops, function (key, value) {\n            if (mapData.pokestops[value] && mapData.pokestops[value].marker) {\n                if (mapData.pokestops[value].marker.rangeCircle) {\n                    mapData.pokestops[value].marker.rangeCircle.setMap(null)\n                }\n                mapData.pokestops[value].marker.setMap(null)\n                delete mapData.pokestops[value]\n            }\n        })\n    }\n}\n\nfunction processGyms(i, item) {\n    if (!Store.get('showGyms')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    var gymLevel = getGymLevel(item.gym_points)\n    var removeGymFromMap = function removeGymFromMap(gymid) {\n        if (mapData.gyms[gymid] && mapData.gyms[gymid].marker) {\n            if (mapData.gyms[gymid].marker.rangeCircle) {\n                mapData.gyms[gymid].marker.rangeCircle.setMap(null)\n            }\n            mapData.gyms[gymid].marker.setMap(null)\n            delete mapData.gyms[gymid]\n        }\n    }\n\n    var gymHasOpenSpot = function gymHasOpenSpot(gymLevel, pokemonInGym) {\n        return gymLevel > item.pokemon.length && item.pokemon.length !== 0\n    }\n\n    if (Store.get('showOpenGymsOnly') === 1) {\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showOpenGymsOnly') > 1) {\n        var closePrestige = 0\n        switch (Store.get('showOpenGymsOnly')) {\n            case 2:\n                closePrestige = 1000\n                break\n            case 3:\n                closePrestige = 2500\n                break\n            case 4:\n                closePrestige = 5000\n                break\n        }\n\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length) && (gymPrestige[gymLevel - 1] > closePrestige + item.gym_points || gymLevel === 10)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showTeamGymsOnly') && Store.get('showTeamGymsOnly') !== item.team_id) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (Store.get('showLastUpdatedGymsOnly')) {\n        var now = new Date()\n        if (item.last_scanned == null) {\n            if (Store.get('showLastUpdatedGymsOnly') * 3600 * 1000 + item.last_modified < now.getTime()) {\n                removeGymFromMap(item['gym_id'])\n                return true\n            }\n        } else {\n            if (Store.get('showLastUpdatedGymsOnly') * 3600 * 1000 + item.last_scanned < now.getTime()) {\n                removeGymFromMap(item['gym_id'])\n                return true\n            }\n        }\n    }\n\n    if (gymLevel < Store.get('minGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (gymLevel > Store.get('maxGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (item['gym_id'] in mapData.gyms) {\n        item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\n    } else {\n        // add marker to map and item to dict\n        item.marker = setupGymMarker(item)\n    }\n    mapData.gyms[item['gym_id']] = item\n}\n\nfunction processScanned(i, item) {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    var scanId = item['latitude'] + '|' + item['longitude']\n\n    if (!(scanId in mapData.scanned)) {\n        // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupScannedMarker(item)\n        mapData.scanned[scanId] = item\n    } else {\n        mapData.scanned[scanId].last_modified = item['last_modified']\n    }\n}\n\nfunction updateScanned() {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    $.each(mapData.scanned, function (key, value) {\n        if (map.getBounds().intersects(value.marker.getBounds())) {\n            value.marker.setOptions({\n                fillColor: getColorByDate(value['last_modified'])\n            })\n        }\n    })\n}\n\nfunction processSpawnpoints(i, item) {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var id = item['spawnpoint_id']\n\n    if (!(id in mapData.spawnpoints)) {\n        // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupSpawnpointMarker(item)\n        mapData.spawnpoints[id] = item\n    }\n}\n\nfunction updateSpawnPoints() {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var zoom = map.getZoom()\n\n    $.each(mapData.spawnpoints, function (key, value) {\n        if (map.getBounds().contains(value.marker.getPosition())) {\n            var hue = getColorBySpawnTime(value['time'])\n            value.marker.setIcon(changeSpawnIcon(hue, zoom))\n            value.marker.setZIndex(spawnPointIndex(hue))\n        }\n    })\n}\n\nfunction updateMap() {\n    loadRawData().done(function (result) {\n        $.each(result.pokemons, processPokemons)\n        $.each(result.pokestops, processPokestops)\n        $.each(result.gyms, processGyms)\n        $.each(result.scanned, processScanned)\n        $.each(result.spawnpoints, processSpawnpoints)\n        showInBoundsMarkers(mapData.pokemons, 'pokemon')\n        showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\n        showInBoundsMarkers(mapData.gyms, 'gym')\n        showInBoundsMarkers(mapData.pokestops, 'pokestop')\n        showInBoundsMarkers(mapData.scanned, 'scanned')\n        showInBoundsMarkers(mapData.spawnpoints, 'inbound'\n            //      drawScanPath(result.scanned)\n        )\n        clearStaleMarkers()\n\n        updateScanned()\n        updateSpawnPoints()\n        updatePokestops()\n\n        if ($('#stats').hasClass('visible')) {\n            countMarkers(map)\n        }\n\n        oSwLat = result.oSwLat\n        oSwLng = result.oSwLng\n        oNeLat = result.oNeLat\n        oNeLng = result.oNeLng\n\n        lastgyms = result.lastgyms\n        lastpokestops = result.lastpokestops\n        lastpokemon = result.lastpokemon\n        lastslocs = result.lastslocs\n        lastspawns = result.lastspawns\n\n        reids = result.reids\n        if (reids instanceof Array) {\n            reincludedPokemon = reids.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, reincludedPokemon)\n        }\n        timestamp = result.timestamp\n        lastUpdateTime = Date.now()\n    })\n}\n\nfunction drawScanPath(points) { // eslint-disable-line no-unused-vars\n    var scanPathPoints = []\n    $.each(points, function (idx, point) {\n        scanPathPoints.push({\n            lat: point['latitude'],\n            lng: point['longitude']\n        })\n    })\n    if (scanPath) {\n        scanPath.setMap(null)\n    }\n    scanPath = new google.maps.Polyline({\n        path: scanPathPoints,\n        geodesic: true,\n        strokeColor: '#FF0000',\n        strokeOpacity: 1.0,\n        strokeWeight: 2,\n        map: map\n    })\n}\n\nfunction redrawPokemon(pokemonList) {\n    var skipNotification = true\n    $.each(pokemonList, function (key, value) {\n        var item = pokemonList[key]\n        if (!item.hidden) {\n            if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\n            var newMarker = setupPokemonMarker(item, map, this.marker.animationDisabled)\n            customizePokemonMarker(newMarker, item, skipNotification)\n            item.marker.setMap(null)\n            pokemonList[key].marker = newMarker\n        }\n    })\n}\n\nvar updateLabelDiffTime = function updateLabelDiffTime() {\n    $('.label-countdown').each(function (index, element) {\n        var disappearsAt = getTimeUntil(parseInt(element.getAttribute('disappears-at')))\n\n        var hours = disappearsAt.hour\n        var minutes = disappearsAt.min\n        var seconds = disappearsAt.sec\n        var timestring = ''\n\n        if (disappearsAt.ttime < disappearsAt.now) {\n            timestring = '(expired)'\n        } else {\n            timestring = '('\n            if (hours > 0) {\n                timestring = hours + 'h'\n            }\n\n            timestring += lpad(minutes, 2, 0) + 'm'\n            timestring += lpad(seconds, 2, 0) + 's'\n            timestring += ')'\n        }\n\n        $(element).text(timestring)\n    })\n}\n\nfunction getPointDistance(pointA, pointB) {\n    return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\n}\n\nfunction sendNotification(title, text, icon, lat, lng) {\n    if (!('Notification' in window)) {\n        return false // Notifications are not present in browser\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    } else {\n        var notification = new Notification(title, {\n            icon: icon,\n            body: text,\n            sound: 'sounds/ding.mp3'\n        })\n\n        notification.onclick = function () {\n            window.focus()\n            notification.close()\n\n            centerMap(lat, lng, 20)\n        }\n    }\n}\n\nfunction createMyLocationButton() {\n    var locationContainer = document.createElement('div')\n\n    var locationButton = document.createElement('button')\n    locationButton.style.backgroundColor = '#fff'\n    locationButton.style.border = 'none'\n    locationButton.style.outline = 'none'\n    locationButton.style.width = '28px'\n    locationButton.style.height = '28px'\n    locationButton.style.borderRadius = '2px'\n    locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\n    locationButton.style.cursor = 'pointer'\n    locationButton.style.marginRight = '10px'\n    locationButton.style.padding = '0px'\n    locationButton.title = 'My Location'\n    locationContainer.appendChild(locationButton)\n\n    var locationIcon = document.createElement('div')\n    locationIcon.style.margin = '5px'\n    locationIcon.style.width = '18px'\n    locationIcon.style.height = '18px'\n    locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\n    locationIcon.style.backgroundSize = '180px 18px'\n    locationIcon.style.backgroundPosition = '0px 0px'\n    locationIcon.style.backgroundRepeat = 'no-repeat'\n    locationIcon.id = 'current-location'\n    locationButton.appendChild(locationIcon)\n\n    locationButton.addEventListener('click', function () {\n        centerMapOnLocation()\n    })\n\n    locationContainer.index = 1\n    map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\n\n    google.maps.event.addListener(map, 'dragend', function () {\n        var currentLocation = document.getElementById('current-location')\n        currentLocation.style.backgroundPosition = '0px 0px'\n    })\n}\n\nfunction centerMapOnLocation() {\n    var currentLocation = document.getElementById('current-location')\n    var imgX = '0'\n    var animationInterval = setInterval(function () {\n        if (imgX === '-18') {\n            imgX = '0'\n        } else {\n            imgX = '-18'\n        }\n        currentLocation.style.backgroundPosition = imgX + 'px 0'\n    }, 500)\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\n            locationMarker.setPosition(latlng)\n            map.setCenter(latlng)\n            Store.set('followMyLocationPosition', {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            })\n            clearInterval(animationInterval)\n            currentLocation.style.backgroundPosition = '-144px 0px'\n        })\n    } else {\n        clearInterval(animationInterval)\n        currentLocation.style.backgroundPosition = '0px 0px'\n    }\n}\n\nfunction changeLocation(lat, lng) { // eslint-disable-line no-unused-vars\n    var loc = new google.maps.LatLng(lat, lng)\n    changeSearchLocation(lat, lng).done(function () {\n        map.setCenter(loc)\n    })\n}\n\nfunction changeSearchLocation(lat, lng) {\n    return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\n}\n\nfunction centerMap(lat, lng, zoom) {\n    var loc = new google.maps.LatLng(lat, lng)\n\n    map.setCenter(loc)\n\n    if (zoom) {\n        storeZoom = false\n        map.setZoom(zoom)\n    }\n}\n\nfunction i8ln(word) {\n    if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\n        $.ajax({\n            url: 'static/dist/locales/' + language + '.min.json',\n            dataType: 'json',\n            async: false,\n            success: function success(data) {\n                i8lnDictionary = data\n            },\n            error: function error(jqXHR, status, _error) {\n                console.log('Error loading i8ln dictionary: ' + _error)\n                languageLookups++\n            }\n        })\n    }\n    if (word in i8lnDictionary) {\n        return i8lnDictionary[word]\n    } else {\n        // Word doesn't exist in dictionary return it as is\n        return word\n    }\n}\n\nfunction updateGeoLocation() {\n    if (navigator.geolocation && Store.get('followMyLocation')) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var lat = position.coords.latitude\n            var lng = position.coords.longitude\n            var center = new google.maps.LatLng(lat, lng)\n\n            if (Store.get('followMyLocation')) {\n                if (typeof locationMarker !== 'undefined' && getPointDistance(locationMarker.getPosition(), center) >= 5) {\n                    map.panTo(center)\n                    locationMarker.setPosition(center)\n                    Store.set('followMyLocationPosition', {\n                        lat: lat,\n                        lng: lng\n                    })\n                }\n            }\n        })\n    }\n}\n\nfunction createUpdateWorker() {\n    try {\n        if (isMobileDevice() && window.Worker) {\n            var updateBlob = new Blob([\"onmessage = function(e) {\\n                var data = e.data\\n                if (data.name === 'backgroundUpdate') {\\n                    self.setInterval(function () {self.postMessage({name: 'backgroundUpdate'})}, 5000)\\n                }\\n            }\"])\n\n            var updateBlobURL = window.URL.createObjectURL(updateBlob)\n\n            updateWorker = new Worker(updateBlobURL)\n\n            updateWorker.onmessage = function (e) {\n                var data = e.data\n                if (document.hidden && data.name === 'backgroundUpdate' && Date.now() - lastUpdateTime > 2500) {\n                    updateMap()\n                    updateGeoLocation()\n                }\n            }\n\n            updateWorker.postMessage({\n                name: 'backgroundUpdate'\n            })\n        }\n    } catch (ex) {\n        console.log('Webworker error: ' + ex.message)\n    }\n}\n\nfunction showGymDetails(id) {\n    // eslint-disable-line no-unused-vars\n    var sidebar = document.querySelector('#gym-details')\n    var sidebarClose\n\n    sidebar.classList.add('visible')\n\n    var data = $.ajax({\n        url: 'gym_data',\n        type: 'GET',\n        timeout: 300000,\n        data: {\n            'id': id\n        },\n        dataType: 'json',\n        cache: false\n    })\n\n    data.done(function (result) {\n        var gymLevel = getGymLevel(result.gym_points)\n        var nextLvlPrestige = gymPrestige[gymLevel - 1] || 50000\n        var prestigePercentage = result.gym_points / nextLvlPrestige * 100\n        var lastModifiedStr = getDateStr(result.last_modified)\n        var lastScannedStr = ''\n        if (result.last_scanned != null) {\n            lastScannedStr =\n                '<div style=\"font-size: .7em\">' +\n                'Last Scanned: ' + getDateStr(result.last_scanned) +\n                '</div>'\n        }\n        var pokemon = result.pokemon !== undefined ? result.pokemon : []\n        var freeSlots = pokemon.length ? gymLevel - pokemon.length : 0\n        var freeSlotsStr = freeSlots ? ' - ' + freeSlots + ' Free Slots' : ''\n        var gymLevelStr = ''\n\n        if (result.team_id === 0) {\n            gymLevelStr =\n                '<center class=\"team-' + result.team_id + '-text\">' +\n                '<b class=\"team-' + result.team_id + '-text\">Uncontested - 1 Free Slot</b>' +\n                '</center>'\n        } else {\n            gymLevelStr =\n                '<div>' +\n                '<b class=\"team-' + result.team_id + '-text\">Level ' + gymLevel + freeSlotsStr + '</b>' +\n                '</div>'\n        }\n\n        var pokemonHtml = ''\n\n        var headerHtml =\n            '<center class=\"team-' + result.team_id + '-text\">' +\n            '<div>' +\n            '<b class=\"team-' + result.team_id + '-text\">' + (result.name || '') + '</b>' +\n            '</div>' +\n            '<img height=\"100px\" style=\"padding: 5px\" src=\"static/forts/' + gymTypes[result.team_id] + '_large.png\">' +\n            '<div class=\"prestige-bar team-' + result.team_id + '\">' +\n            '<div class=\"prestige team-' + result.team_id + '\" style=\"width: ' + prestigePercentage + '%\">' +\n            '</div>' +\n            '</div>' +\n            '<div>' +\n            result.gym_points + '/' + nextLvlPrestige +\n            '</div>' +\n            gymLevelStr +\n            '<div style=\"font-size: .7em\">' +\n            'Last Modified: ' + lastModifiedStr +\n            '</div>' +\n            lastScannedStr +\n            '<div>' +\n            '<a href=\\'javascript:void(0)\\' onclick=\\'javascript:openMapDirections(' + result.latitude + ',' + result.longitude + ')\\' title=\\'View in Maps\\'>Get directions</a>' +\n            '</div>' +\n            '</center>'\n\n        if (pokemon.length) {\n            $.each(pokemon, function (i, pokemon) {\n                var perfectPercent = getIv(pokemon.iv_attack, pokemon.iv_defense, pokemon.iv_stamina)\n                var moveEnergy = Math.round(100 / pokemon.move_2_energy)\n\n                pokemonHtml +=\n                    '<tr onclick=toggleGymPokemonDetails(this)>' +\n                    '<td width=\"30px\">' +\n                    '<i class=\"pokemon-sprite n' + pokemon.pokemon_id + '\"></i>' +\n                    '</td>' +\n                    '<td class=\"team-' + result.team_id + '-text\">' +\n                    '<div style=\"line-height:1em\">' + pokemon.pokemon_name + '</div>' +\n                    '<div class=\"cp\">CP ' + pokemon.pokemon_cp + '</div>' +\n                    '</td>' +\n                    '<td width=\"190\" class=\"team-' + result.team_id + '-text\" align=\"center\">' +\n                    '<div class=\"trainer-level\">' + pokemon.trainer_level + '</div>' +\n                    '<div style=\"line-height: 1em\">' + pokemon.trainer_name + '</div>' +\n                    '</td>' +\n                    '<td width=\"10\">' +\n                    '<!--<a href=\"#\" onclick=\"toggleGymPokemonDetails(this)\">-->' +\n                    '<i class=\"team-' + result.team_id + '-text fa fa-angle-double-down\"></i>' +\n                    '<!--</a>-->' +\n                    '</td>' +\n                    '</tr>' +\n                    '<tr class=\"details\">' +\n                    '<td colspan=\"2\">' +\n                    '<div class=\"ivs\">' +\n                    '<div class=\"iv\">' +\n                    '<div class=\"type\">ATK</div>' +\n                    '<div class=\"value\">' +\n                    pokemon.iv_attack +\n                    '</div>' +\n                    '</div>' +\n                    '<div class=\"iv\">' +\n                    '<div class=\"type\">DEF</div>' +\n                    '<div class=\"value\">' +\n                    pokemon.iv_defense +\n                    '</div>' +\n                    '</div>' +\n                    '<div class=\"iv\">' +\n                    '<div class=\"type\">STA</div>' +\n                    '<div class=\"value\">' +\n                    pokemon.iv_stamina +\n                    '</div>' +\n                    '</div>' +\n                    '<div class=\"iv\" style=\"width: 36px\">' +\n                    '<div class=\"type\">PERFECT</div>' +\n                    '<div class=\"value\">' +\n                    perfectPercent.toFixed(0) + '' +\n                    '<span style=\"font-size: .6em\">%</span>' +\n                    '</div>' +\n                    '</div>' +\n                    '</div>' +\n                    '</td>' +\n                    '<td colspan=\"2\">' +\n                    '<div class=\"moves\">' +\n                    '<div class=\"move\">' +\n                    '<div class=\"name\">' +\n                    pokemon.move_1_name +\n                    ' <div class=\"type ' + pokemon.move_1_type.toLowerCase() + '\">' + pokemon.move_1_type + '</div>' +\n                    '</div>' +\n                    '<div class=\"damage\">' +\n                    pokemon.move_1_damage +\n                    '</div>' +\n                    '</div>' +\n                    '<br>' +\n                    '<div class=\"move\">' +\n                    '<div class=\"name\">' +\n                    pokemon.move_2_name +\n                    ' <div class=\"type ' + pokemon.move_2_type.toLowerCase() + '\">' + pokemon.move_2_type + '</div>' +\n                    '<div>' +\n                    '<i class=\"move-bar-sprite move-bar-sprite-' + moveEnergy + '\"></i>' +\n                    '</div>' +\n                    '</div>' +\n                    '<div class=\"damage\">' +\n                    pokemon.move_2_damage +\n                    '</div>' +\n                    '</div>' +\n                    '</div>' +\n                    '</td>' +\n                    '</tr>'\n            })\n\n            pokemonHtml = '<table><tbody>' + pokemonHtml + '</tbody></table>'\n        } else if (result.team_id === 0) {\n            pokemonHtml = ''\n        } else {\n            pokemonHtml =\n                '<center class=\"team-' + result.team_id + '-text\">' +\n                'Gym Leader:<br>' +\n                '<i class=\"pokemon-large-sprite n' + result.guard_pokemon_id + '\"></i><br>' +\n                '<b class=\"team-' + result.team_id + '-text\">' + result.guard_pokemon_name + '</b>' +\n                '<p style=\"font-size: .75em margin: 5px\">' +\n                'No additional gym information is available for this gym. Make sure you are collecting detailed gym info. If you have detailed gym info collection running, this gym\\'s Pokemon information may be out of date.' +\n                '</p>' +\n                '</center>'\n        }\n\n        sidebar.innerHTML = headerHtml + pokemonHtml\n\n        sidebarClose = document.createElement('a')\n        sidebarClose.href = '#'\n        sidebarClose.className = 'close'\n        sidebarClose.tabIndex = 0\n        sidebar.appendChild(sidebarClose)\n\n        sidebarClose.addEventListener('click', function (event) {\n            event.preventDefault()\n            event.stopPropagation()\n            sidebar.classList.remove('visible')\n        })\n    })\n}\n\nfunction toggleGymPokemonDetails(e) { // eslint-disable-line no-unused-vars\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-up')\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-down')\n    e.nextElementSibling.classList.toggle('visible')\n}\n\n//\n// Page Ready Exection\n//\n\n$(function () {\n    try {\n        if (!Notification) {\n            console.log('could not load notifications')\n            return\n        }\n    } catch (err) {\n    }\n\n    try {\n        if (Notification.permission !== 'granted') {\n            Notification.requestPermission()\n        }\n    } catch (err) {\n    }\n})\n\n$(function () {\n    // populate Navbar Style menu\n    $selectStyle = $('#map-style'\n\n        // Load Stylenames, translate entries, and populate lists\n    )\n    $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\n        var styleList = []\n\n        $.each(data, function (key, value) {\n            styleList.push({\n                id: key,\n                text: i8ln(value)\n            })\n        })\n\n        // setup the stylelist\n        $selectStyle.select2({\n            placeholder: 'Select Style',\n            data: styleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        // setup the list change behavior\n        $selectStyle.on('change', function (e) {\n            selectedStyle = $selectStyle.val()\n            map.setMapTypeId(selectedStyle)\n            Store.set('map_style', selectedStyle)\n        })\n\n        // recall saved mapstyle\n        $selectStyle.val(Store.get('map_style')).trigger('change')\n    })\n\n    $selectIconResolution = $('#pokemon-icons')\n\n    $selectIconResolution.select2({\n        placeholder: 'Select Icon Resolution',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectIconResolution.on('change', function () {\n        Store.set('pokemonIcons', this.value)\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    $selectIconSize = $('#pokemon-icon-size')\n\n    $selectIconSize.select2({\n        placeholder: 'Select Icon Size',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectIconSize.on('change', function () {\n        Store.set('iconSizeModifier', this.value)\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    $selectOpenGymsOnly = $('#open-gyms-only-switch')\n\n    $selectOpenGymsOnly.select2({\n        placeholder: 'Only Show Open Gyms',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectOpenGymsOnly.on('change', function () {\n        Store.set('showOpenGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectTeamGymsOnly = $('#team-gyms-only-switch')\n\n    $selectTeamGymsOnly.select2({\n        placeholder: 'Only Show Gyms For Team',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectTeamGymsOnly.on('change', function () {\n        Store.set('showTeamGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLastUpdateGymsOnly = $('#last-update-gyms-switch')\n\n    $selectLastUpdateGymsOnly.select2({\n        placeholder: 'Only Show Gyms Last Updated',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLastUpdateGymsOnly.on('change', function () {\n        Store.set('showLastUpdatedGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMinGymLevel = $('#min-level-gyms-filter-switch')\n\n    $selectMinGymLevel.select2({\n        placeholder: 'Minimum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMinGymLevel.on('change', function () {\n        Store.set('minGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMaxGymLevel = $('#max-level-gyms-filter-switch')\n\n    $selectMaxGymLevel.select2({\n        placeholder: 'Maximum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMaxGymLevel.on('change', function () {\n        Store.set('maxGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\n\n    $selectLuredPokestopsOnly.select2({\n        placeholder: 'Only Show Lured Pokestops',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLuredPokestopsOnly.on('change', function () {\n        Store.set('showLuredPokestopsOnly', this.value)\n        lastpokestops = false\n        updateMap()\n    })\n    $switchGymSidebar = $('#gym-sidebar-switch')\n\n    $switchGymSidebar.on('change', function () {\n        Store.set('useGymSidebar', this.checked)\n        lastgyms = false\n        $.each(['gyms'], function (d, dType) {\n            $.each(mapData[dType], function (key, value) {\n                // for any marker you're turning off, you'll want to wipe off the range\n                if (mapData[dType][key].marker.rangeCircle) {\n                    mapData[dType][key].marker.rangeCircle.setMap(null)\n                    delete mapData[dType][key].marker.rangeCircle\n                }\n                mapData[dType][key].marker.setMap(null)\n            })\n            mapData[dType] = {}\n        })\n        updateMap()\n    })\n\n    $selectLocationIconMarker = $('#locationmarker-style')\n\n    $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\n        searchMarkerStyles = data\n        var searchMarkerStyleList = []\n\n        $.each(data, function (key, value) {\n            searchMarkerStyleList.push({\n                id: key,\n                text: value.name\n            })\n        })\n\n        locationMarker = createLocationMarker()\n\n        $selectLocationIconMarker.select2({\n            placeholder: 'Select Location Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectLocationIconMarker.on('change', function (e) {\n            Store.set('locationMarkerStyle', this.value)\n            updateLocationMarker(this.value)\n        })\n\n        $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\n    })\n\n    $selectGymMarkerStyle = $('#gym-marker-style')\n\n    $selectGymMarkerStyle.select2({\n        placeholder: 'Select Style',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectGymMarkerStyle.on('change', function (e) {\n        Store.set('gymMarkerStyle', this.value)\n        updateGymIcons()\n    })\n\n    $selectGymMarkerStyle.val(Store.get('gymMarkerStyle')).trigger('change')\n})\n\n$(function () {\n    function formatState(state) {\n        if (!state.id) {\n            return state.text\n        }\n        var $state = $('<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>')\n        return $state\n    }\n\n    if (Store.get('startAtUserLocation')) {\n        centerMapOnLocation()\n    }\n\n    $.getJSON('static/dist/data/moves.min.json').done(function (data) {\n        moves = data\n    })\n\n    $selectExclude = $('#exclude-pokemon')\n    $selectPokemonNotify = $('#notify-pokemon')\n    $selectRarityNotify = $('#notify-rarity')\n    $textPerfectionNotify = $('#notify-perfection')\n    var numberOfPokemon = 493\n\n    // Load pokemon names and populate lists\n    $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\n        var pokeList = []\n\n        $.each(data, function (key, value) {\n            if (key > numberOfPokemon) {\n                return false\n            }\n            var _types = []\n            pokeList.push({\n                id: key,\n                text: i8ln(value['name']) + ' - #' + key\n            })\n            value['name'] = i8ln(value['name'])\n            value['rarity'] = i8ln(value['rarity'])\n            $.each(value['types'], function (key, pokemonType) {\n                _types.push({\n                    'type': i8ln(pokemonType['type']),\n                    'color': pokemonType['color']\n                })\n            })\n            value['types'] = _types\n            idToPokemon[key] = value\n        })\n\n        // setup the filter lists\n        $selectExclude.select2({\n            placeholder: i8ln('Select Pokémon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectPokemonNotify.select2({\n            placeholder: i8ln('Select Pokémon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectRarityNotify.select2({\n            placeholder: i8ln('Select Rarity'),\n            data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\n            templateResult: formatState\n        })\n\n        // setup list change behavior now that we have the list to work from\n        $selectExclude.on('change', function (e) {\n            buffer = excludedPokemon\n            excludedPokemon = $selectExclude.val().map(Number)\n            buffer = buffer.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, excludedPokemon)\n            reincludedPokemon = reincludedPokemon.concat(buffer)\n            clearStaleMarkers()\n            Store.set('remember_select_exclude', excludedPokemon)\n        })\n        $selectPokemonNotify.on('change', function (e) {\n            notifiedPokemon = $selectPokemonNotify.val().map(Number)\n            Store.set('remember_select_notify', notifiedPokemon)\n        })\n        $selectRarityNotify.on('change', function (e) {\n            notifiedRarity = $selectRarityNotify.val().map(String)\n            Store.set('remember_select_rarity_notify', notifiedRarity)\n        })\n        $textPerfectionNotify.on('change', function (e) {\n            notifiedMinPerfection = parseInt($textPerfectionNotify.val(), 10)\n            if (isNaN(notifiedMinPerfection) || notifiedMinPerfection <= 0) {\n                notifiedMinPerfection = ''\n            }\n            if (notifiedMinPerfection > 100) {\n                notifiedMinPerfection = 100\n            }\n            $textPerfectionNotify.val(notifiedMinPerfection)\n            Store.set('remember_text_perfection_notify', notifiedMinPerfection)\n        })\n\n        // recall saved lists\n        $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\n        $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\n        $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\n        $textPerfectionNotify.val(Store.get('remember_text_perfection_notify')).trigger('change')\n\n        if (isTouchDevice() && isMobileDevice()) {\n            $('.select2-search input').prop('readonly', true)\n        }\n    })\n\n    // run interval timers to regularly update map and timediffs\n    window.setInterval(updateLabelDiffTime, 1000)\n    window.setInterval(updateMap, 5000)\n    window.setInterval(updateGeoLocation, 1000)\n\n    createUpdateWorker()\n\n    // Wipe off/restore map icons when switches are toggled\n    function buildSwitchChangeListener(data, dataType, storageKey) {\n        return function () {\n            Store.set(storageKey, this.checked)\n            if (this.checked) {\n                // When switch is turned on we asume it has been off, makes sure we dont end up in limbo\n                // Without this there could've been a situation where no markers are on map and only newly modified ones are loaded\n                if (storageKey === 'showPokemon') {\n                    lastpokemon = false\n                } else if (storageKey === 'showGyms') {\n                    lastgyms = false\n                } else if (storageKey === 'showPokestops') {\n                    lastpokestops = false\n                } else if (storageKey === 'showScanned') {\n                    lastslocs = false\n                } else if (storageKey === 'showSpawnpoints') {\n                    lastspawns = false\n                }\n                updateMap()\n            } else {\n                $.each(dataType, function (d, dType) {\n                    $.each(data[dType], function (key, value) {\n                        // for any marker you're turning off, you'll want to wipe off the range\n                        if (data[dType][key].marker.rangeCircle) {\n                            data[dType][key].marker.rangeCircle.setMap(null)\n                            delete data[dType][key].marker.rangeCircle\n                        }\n                        if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\n                    })\n                    if (storageKey !== 'showRanges') data[dType] = {}\n                })\n                if (storageKey === 'showRanges') {\n                    updateMap()\n                }\n            }\n        }\n    }\n\n    // Setup UI element interactions\n    $('#gyms-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#gym-sidebar-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper.show(options)\n        } else {\n            lastgyms = false\n            wrapper.hide(options)\n        }\n        var wrapper2 = $('#gyms-filter-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper2.show(options)\n        } else {\n            lastgyms = false\n            wrapper2.hide(options)\n        }\n        buildSwitchChangeListener(mapData, ['gyms'], 'showGyms').bind(this)()\n    })\n    $('#pokemon-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon').bind(this)()\n    })\n    $('#scanned-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['scanned'], 'showScanned').bind(this)()\n    })\n    $('#spawnpoints-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints').bind(this)()\n    })\n    $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\n\n    $('#pokestops-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#lured-pokestops-only-wrapper')\n        if (this.checked) {\n            lastpokestops = false\n            wrapper.show(options)\n        } else {\n            lastpokestops = false\n            wrapper.hide(options)\n        }\n        return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\n    })\n\n    $('#sound-switch').change(function () {\n        Store.set('playSound', this.checked)\n    })\n\n    $('#start-at-user-location-switch').change(function () {\n        Store.set('startAtUserLocation', this.checked)\n    })\n\n    $('#follow-my-location-switch').change(function () {\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('followMyLocation', this.checked)\n        }\n        locationMarker.setDraggable(!this.checked)\n    })\n\n    if ($('#nav-accordion').length) {\n        $('#nav-accordion').accordion({\n            active: 0,\n            collapsible: true,\n            heightStyle: 'content'\n        })\n    }\n\n    // Initialize dataTable in statistics sidebar\n    //   - turn off sorting for the 'icon' column\n    //   - initially sort 'name' column alphabetically\n\n    $('#pokemonList_table').DataTable({\n        paging: false,\n        searching: false,\n        info: false,\n        errMode: 'throw',\n        'language': {\n            'emptyTable': ''\n        },\n        'columns': [{'orderable': false}, null, null, null]\n    }).order([1, 'asc'])\n})\n"]}